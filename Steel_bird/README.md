# Оптимизация производственных расходов металлургического комбината «Стальная птица»

**ЦЕЛЬ ПРОЕКТА:** Построить модель, которая будет предсказывать температуру сплава.

**Описание проекта: промышленность**

Чтобы оптимизировать производственные расходы, металлургический комбинат «Стальная птица» решил уменьшить потребление электроэнергии на этапе обработки стали. Для этого комбинату нужно контролировать температуру сплава. 

Ваша задача — построить модель, которая будет её предсказывать. 

**Описание данных**

1. Файл `data_arc_new.csv` - данные об электродах:  
- `key` — номер партии;   
- `Начало нагрева дугой` — время начала нагрева;   
- `Конец нагрева дугой` — время окончания нагрева;  
- `Активная мощность` — значение активной мощности;  
- `Реактивная мощность` — значение реактивной мощности.  

2. Файл `data_bulk_new.csv` - данные о подаче сыпучих материалов (объём):
- `key`— номер партии;  
- `Bulk 1` … `Bulk 15` — объём подаваемого материала.  

3. Файл `data_bulk_time_new.csv` - данные о подаче сыпучих материалов (время):  
- `key` — номер партии;  
- `Bulk 1` … `Bulk 15` — время подачи материала.  

4. Файл `data_gas_new.csv` - данные о продувке сплава газом;  
- `key` — номер партии;  
- `Газ 1` — объём подаваемого газа.  

5. Файл `data_temp_new.csv` - результаты измерения температуры:  
- `key` — номер партии;  
- `Время замера` — время замера;  
- `Температура` — значение температуры.  

6. Файл `data_wire_new.csv` - данные о проволочных материалах (объём):  
- `key` — номер партии;  
- `Wire 1` … `Wire 9` — объём подаваемых проволочных материалов.  

7. Файл `data_wire_time_new.csv` - данные о проволочных материалах (время):  
- `key` — номер партии;  
- `Wire 1` … `Wire 9` — время подачи проволочных материалов.  

Во всех файлах столбец key содержит номер партии. В файлах может быть несколько строк с одинаковым значением key: они соответствуют разным итерациям обработки.

## Выводы

1. Были загружены и проанализированы полученные датасеты.  
2. В ходе предобработки и исследовательского анализа датасетов:  
    - названия столбцов датасетов было приведено к формату PEP8;  
    - столбцы с временными данными были приведены к формату datetime;
    - столбцы с большим количеством пропусков (более 85%) были убраны из датасетов;
    - необходимые датасеты были сгруппированы по партиям;
    - были убраны партии с аномальными значениями реактивной мощности < 0;
    - были созданы новые входные признаки из данных находящихся в датасете;
    - был проведен статистический анализ датасетов и сделаны выводы.
3. Была создана объединенная таблица, в которой использовали все датасеты, кроме `data_bulk_time_new` и `data_wire_time_new`. Итоговый размер датасета (2329, 19).

<img width="2006" height="201" alt="image" src="https://github.com/user-attachments/assets/bf46d593-f23e-43db-822f-59f706b995d1" />

4. Была произведена предобработка датасета и его анализ в ходе которых:
    - все пропуски в столбцах подачи материалов заменены на 0;
    - были удалены столбцы `key`, `first_time` и `finish_time` не несущие смысловой нагрузки или создающие мультиколлинеарность в датасете;
    - был проведен корреляционный и статистический анализ итогового датасета для машинного обучения.
5. Были подготовлены данные для МО, датасет был разделен на тренировочную и тестовую выборку в соотношении 3:1.
6. Были обучены 4 модели машинного обучения: `DummyRegressor`, `LinearRegression`, `RandomForestRegressor` и `CatBoostRegressor`. И подобраны гиперпараметры с помощью `GridSearchCV`.
7. Был произведен выбор лучшей модели и ее анализ:
    - в ходе подбора гиперпараметров с помощью `GridSearchCV` была определена лучшая модель на обучающей выборке - ей оказалась `CatBoostRegressor` с гиперпараметрами ('model__learning_rate': 0.01, 'preprocessor__num__scaler': 'passthrough') и метрикой качества `MAE=5.97`;
    - модель `CatBoostRegressor` показала удволетворяющее условию качество на тестовой выборке `MAE=6.5` (менее 6.8);  
    - модель `CatBoostRegressor` была проверена на адекватность путем сравнения ее метрики качества МАЕ на тестовой выборке с констанстной моделью `DummyRegressor`. Метрика качества МАЕ для модели `CatBoostRegressor` оказалась ниже (6.5 против 8.54). Что подтвердило адекватность и целесообразность использования для предсказания финальной температуры после обработки материала полученную модель CatBoostRegressor();
    - был проведен анализ важности входных признаков на предсказание модели, наиболее важными признаками являются: `heating_time` (время требующееся на нагрев) и `first_temp` начальная температура материала.
    
    
 Рекомендация в ходе проделанной работы - **уделить внимание точности и своевременности замеров температуры.**
